# Instantiate the stack detached from log output
docker-compose up -d

# Output the container logs and follow
docker-compose logs -f

# Output the container logs and follow for a specific container
docker-compose logs -f streamsets

# Terminate the stack
docker-compose down

# Check the stack status
docker-compose ps

# Pause and unpause the stack
docker-compose pause
docker-compose unpause

# Restart the stack
docker-compose restart

# Run if you have done changes to a running container and you want to save them to an image
docker commit -t hvbnext/streamsets:mychanges <container id>

# Save image to registry if you have write permission to the repository (here Docker Hub hvbnext account)
docker push hvbnext/streamsets:mychanges

# Remove existing container and images
docker image rm --force hvbnext/infometis-local:v1
docker image rm --force hvbnext/zookeeper:base
docker image rm --force hvbnext/kafka:base
docker image rm --force hvbnext/kafka-manager:base
docker image rm --force hvbnext/filebeat:docker
docker image rm --force hvbnext/metricbeat:local
docker image rm --force hvbnext/streamsets:local
docker image rm --force hvbnext/streamsets:dev
docker image rm --force hvbnext/elasticsearch:base
docker image rm --force hvbnext/kibana:local
docker image rm --force hvbnext/grafana:local

##################### CONFIGURATION #####################################

docker-compose -f docker-compose-config.yml up -d

# import pipelines in streamsets and streamsets-local
# import saved objects in kibana
# register kafka in kafka-manager

docker commit elasticsearch vc11web/elasticsearch:infometis-local_v1
docker commit kafka-manager vc11web/kafka-manager:infometis-local_v1
docker commit streamsets-local vc11web/streamsets:infometis-local_v1

docker-compose -f docker-compose-config.yml down

docker tag vc11web/elasticsearch:infometis-local_v1 vc11web/elasticsearch:infometis-local_v1_cc
docker tag vc11web/kafka-manager:infometis-local_v1 vc11web/kafka-manager:infometis-local_v1_cc
docker tag vc11web/streamsets:infometis-local_v1 vc11web/streamsets:infometis-local_v1_cc

docker push vc11web/elasticsearch:infometis-local_v1_cc
docker push vc11web/kafka-manager:infometis-local_v1_cc
docker push vc11web/streamsets:infometis-local_v1_cc

docker-compose up -d

# remove images

docker image rm --force vc11web/infometis-local:v1
docker image rm --force vc11web/streamsets:infometis-local_v1
docker image rm --force vc11web/streamsets:infometis-local_v1_cc
docker image rm --force vc11web/streamsets:infometis-local_v1_dev
docker image rm --force vc11web/kafka-manager:infometis-local_v1
docker image rm --force vc11web/kafka-manager:infometis-local_v1_cc
docker image rm --force vc11web/grafana:infometis-local_v1
docker image rm --force vc11web/elasticsearch:infometis-local_v1
docker image rm --force vc11web/elasticsearch:infometis-local_v1_cc
docker image rm --force vc11web/kibana:infometis-local_v1
docker image rm --force vc11web/kafka:infometis-local_v1
docker image rm --force vc11web/zookeeper:infometis-local_v1
docker image rm --force vc11web/metricbeat:infometis-local_v1
docker image rm --force vc11web/ksql-server:infometis-local_v1
docker image rm --force vc11web/filebeat:infometis-local_v1_docker


# tag images under hvbnext account

docker tag vc11web/infometis-local:v1 hvbnext/infometis-local:v1
docker tag vc11web/zookeeper:base hvbnext/zookeeper:base
docker tag vc11web/kafka:base hvbnext/kafka:base
docker tag vc11web/kafka-manager:base hvbnext/kafka-manager:base
docker tag vc11web/filebeat:docker hvbnext/filebeat:docker
docker tag vc11web/metricbeat:local hvbnext/metricbeat:local
docker tag vc11web/elasticsearch:local hvbnext/elasticsearch:local
docker tag vc11web/streamsets:dev hvbnext/streamsets:dev
docker tag vc11web/streamsets:local hvbnext/streamsets:local
docker tag vc11web/kibana:local hvbnext/kibana:local
docker tag vc11web/grafana:local hvbnext/grafana:local

docker push hvbnext/infometis-local:v1
docker push hvbnext/zookeeper:base
docker push hvbnext/kafka:base
docker push hvbnext/kafka-manager:base
docker push hvbnext/filebeat:docker
docker push hvbnext/metricbeat:local
docker push hvbnext/elasticsearch:local
docker push hvbnext/streamsets:dev
docker push hvbnext/streamsets:local
docker push hvbnext/kibana:local
docker push hvbnext/grafana:local
